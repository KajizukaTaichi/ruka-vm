# Ruka VM
手軽な命令セットアーキテクチャを採用した軽量仮想マシン

## システム構成
|名前|説明|サイズ|読み込み|書き込み|
|---|---|---|---|---|
|プログラム領域|実行されるバイトコードを格納|可変長|不可|不可|
|メモリ領域|データやオブジェクトを格納|512バイト固定|可能(アドレス指定)|可能|
|スタック領域|関数などとのデータ受け渡し用|可変長|可能(ポップのみ)|可能(プッシュのみ)|
|関数スタック|呼び出し元アドレスが積まれる|可変長|不可|不可|
|レジスタ群|演算時の一時的なデータ格納用|64ビット固定|可能|可能|

※ 全ての値は64ビット浮動小数点数(f64)です。

## ISA
|ニーモニック|意味|
|---|---|
|MOV レジスタ, 値|データ転送|
|ADD レジスタ, 値|足し算|
|MUL レジスタ, 値|掛け算|
|NEG レジスタ|符号反転|
|INV レジスタ|逆数|
|EQL レジスタ, 値|等価比較|
|LES レジスタ, 値|大小比較|
|NOR レジスタ, 値|論理ORして否定|
|JMP 条件, アドレス|条件つきジャンプ|
|CAL アドレス|関数呼び出し|
|RET|呼び出し元に戻る|
|LDA レジスタ, アドレス|データ読み込み|
|STA アドレス, 値|データ書き込み|
|PSH 値|スタックに追加|
|POP レジスタ|スタックから取り出し|
|NOP|何もしない|
|HLT|プログラム終了|

## レジスタ
|名前|意味|役割|
|---|---|---|
|PC|Program Counter|次の命令のアドレス|
|AR|Accumulator Register|演算結果の格納|
|DR|Data Register|データの格納|
|CR|Conditional Register|条件の格納|
|BA|Base Address|メモリの基底アドレス|
|SP|Stack Pointer|スタックに長さ|
