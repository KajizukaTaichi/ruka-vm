# Ruka VM
手軽な命令セットアーキテクチャを採用した軽量仮想マシン

## システム構成
|||読み込み|書き込み|
|---|---|---|
|プログラム領域|実行されるバイトコードが格納されます|不可|不可|
|メモリ領域|データやオブジェクトが格納されます|可能(アドレス指定)|可能(アドレス指定)|
|スタック領域|関数などとデータを受け渡す際に使います。|可能(ポップのみ)|可能(プッシュのみ)|
|関数スタック|呼び出し元アドレスが格納されます|不可|不可|
|レジスタユニット|プログラムの実行に必要なレジスタが格納されます|不可|不可|

レジスタの型は全て64ビット浮動小数点数(f64)です。<br>
メモリは固定512バイトで、8バイト毎にアドレスが振られています。各セルも同じくf64です。

## ISA
|ニーモニック|意味|
|---|---|
|MOV レジスタ, 値|データ転送|
|ADD レジスタ, 値|足し算|
|MUL レジスタ, 値|掛け算|
|NEG レジスタ|符号反転|
|INV レジスタ|逆数|
|EQL レジスタ, 値|等価比較|
|LES レジスタ, 値|大小比較|
|NOR レジスタ, 値|論理ORして否定|
|JMP 条件, アドレス|条件つきジャンプ|
|CAL アドレス|関数呼び出し|
|RET|呼び出し元に戻る|
|LDA レジスタ, アドレス|データ読み込み|
|STA アドレス, 値|データ書き込み|
|PSH 値|スタックに追加|
|POP レジスタ|スタックから取り出し|
|NOP|何もしない|
|HLT|プログラム終了|

## レジスタ
|名前|意味|役割|
|---|---|---|
|PC|Program Counter|次の命令のアドレス|
|AR|Accumulator Register|演算結果の格納|
|DR|Data Register|データの格納|
|CR|Conditional Register|条件の格納|
|BA|Base Address|メモリの基底アドレス|
|SP|Stack Pointer|スタックに長さ|
